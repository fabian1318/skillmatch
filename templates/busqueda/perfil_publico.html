{% extends 'base.html' %}

{% block title %}Perfil de {{ perfil.first_name }}{% endblock %}

{% block content %}
<div class="row">
    <!-- Tarjeta de Presentación (Columna Izquierda) -->
    <div class="col-md-4">
        <div class="card card-custom text-center mb-4">
            <div class="card-body-custom">
                <!-- Avatar -->
                <div class="rounded-circle bg-light d-flex justify-content-center align-items-center mx-auto mb-3 fw-bold fs-1 text-secondary" style="width: 120px; height: 120px;">
                    {{ perfil.first_name|slice:":1" }}{{ perfil.last_name|slice:":1" }}
                </div>
                
                <!-- Nombre y Carrera -->
                <h3 class="fw-bold">{{ perfil.first_name }} {{ perfil.last_name }}</h3>
                <p class="text-muted">{{ perfil.carrera|default:"Carrera no especificada" }}</p>
                
                <!-- Biografía -->
                <div class="border-top pt-3 mt-3 text-start">
                    <h6 class="fw-bold small text-uppercase">Sobre mí</h6>
                    <p class="small text-muted">{{ perfil.biografia|default:"Sin descripción." }}</p>
                </div>
                
                <!-- BOTÓN REPORTAR (HU-22) -->
                <div class="mt-4 pt-3 border-top text-center">
                    <a href="{% url 'reportar_usuario' perfil.id %}" class="text-danger small text-decoration-none opacity-75 hover-opacity-100">
                        <i class="bi bi-flag-fill me-1"></i>Reportar conducta inapropiada
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Habilidades Disponibles (Columna Derecha) -->
    <div class="col-md-8">
        <h4 class="fw-bold mb-3">Habilidades que ofrece {{ perfil.first_name }}</h4>
        <p class="text-muted mb-4">Selecciona una habilidad para iniciar un intercambio.</p>
        
        <div class="row">
            {% for hab in perfil.habilidades_ofrecidas.all %}
                <div class="col-md-6 mb-3">
                    <div class="card card-custom h-100 border-start border-4 border-success">
                        <div class="card-body-custom d-flex justify-content-between align-items-center">
                            <div>
                                <h5 class="fw-bold mb-1">{{ hab.nombre }}</h5>
                                <small class="text-muted">Disponible para enseñar</small>
                            </div>
                            
                            <!-- BOTÓN SOLICITAR (HU-21) -->
                            <a href="{% url 'iniciar_solicitud' perfil.id hab.id %}" class="btn btn-sm btn-outline-success rounded-pill fw-bold">
                                Solicitar <i class="bi bi-arrow-right ms-1"></i>
                            </a>
                        </div>
                    </div>
                </div>
            {% empty %}
                <div class="col-12">
                    <div class="alert alert-warning border-0 shadow-sm">
                        <i class="bi bi-exclamation-circle me-2"></i>
                        Este usuario aún no ha registrado habilidades para ofrecer.
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}